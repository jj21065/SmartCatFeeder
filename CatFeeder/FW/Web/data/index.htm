<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ESP8266 Smart Home project</title>
    <link href="css/jquery-ui.min.css" rel="stylesheet" type="text/css" />
    <style type="text/css">
      body {
        font-family: "微軟正黑體", "黑體-繁", sans-serif;
      }
      #slider {
        width: 300px;
        margin: 15px;
      }
      #timerSettings {
        margin-top: 20px;
      }

      div {
        display: flex;
      }
      div .white-content {
        height: 155px;
        /* left: 0px;
        top: 0px;
        position: absolute; */
        width: 100%;
        display: flex !important;
      }
      .group {
        justify-content: center;
        align-items: center;
        width: 100%;
      }
      .FeedButton {
        position: absolute;

        background-color: #0a0a23 !important;
        color: #fff;
        border-radius: 25px;
        height: 50;
        margin: 16;
        text-align: center;
        font-size: 16px;
        font-family: SF Pro Text;
        font-weight: 700;
        text-transform: uppercase;
        word-wrap: break-word;
      }
    </style>
  </head>

  <body>
    <div
      class="LoggedOut"
      style="
        width: 100%;
        height: 812px;
        position: relative;
        background: #4c4c4c;
        display: flex;
        flex-direction: column;
      "
    >
      <div
        class="StatusBar"
        style="
          padding-top: 8px;
          padding-bottom: 13px;
          padding-left: 21px;
          padding-right: 14px;
          left: 0px;
          top: 0px;
          position: absolute;
          justify-content: flex-end;
          align-items: flex-end;
          gap: 216px;
          display: inline-flex;
        "
      ></div>
      <div
        class="Register"
        style="
          left: 243px;
          top: 729px;
          position: absolute;
          text-align: center;
          color: black;
          font-size: 13px;
          font-family: SF Pro Text;
          font-weight: 700;
          text-transform: uppercase;
          word-wrap: break-word;
        "
      >
        register
      </div>
      <div
        class="Button"
        style="
          width: 167px;
          height: 52px;
          left: 16px;
          top: 727px;
          position: absolute;
        "
      >
        <div
          class="Rectangle2"
          style="
            width: 167px;
            height: 52px;
            left: 0px;
            top: 0px;
            position: absolute;
            background: white;
            border-radius: 6px;
            border: 2px black solid;
          "
        ></div>
        <div
          class="LogIn"
          style="
            left: 61px;
            top: 19px;
            position: absolute;
            text-align: center;
            color: black;
            font-size: 13px;
            font-family: Roboto;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 0.52px;
            word-wrap: break-word;
          "
        >
          log in
        </div>
      </div>
      <div
        class="Button"
        style="
          width: 167px;
          height: 52px;
          left: 192px;
          top: 727px;
          position: absolute;
        "
      >
        <div
          class="Rectangle2"
          style="
            width: 167px;
            height: 52px;
            left: 0px;
            top: 0px;
            position: absolute;
            background: black;
            border-radius: 6px;
          "
        ></div>
        <div
          class="Register"
          style="
            left: 51px;
            top: 19px;
            position: absolute;
            text-align: center;
            color: white;
            font-size: 13px;
            font-family: Roboto;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 0.52px;
            word-wrap: break-word;
          "
        >
          register
        </div>
      </div>
      <div class="white-content" style="background-color: #2c2c2c">
        <div class="group">
          <div>
            <img
              class="Union"
              style="width: 90px; height: 90px"
              src="css/images/catLogo_pic.png"
            />
            <!-- <div
              class="circleBackground"
              style="border-radius: 50%; color: #8f8f8f; width: 90; height: 90"
            ></div> -->
          </div>
          <div
            class="Photo"
            style="
              text-align: center;
              color: white;
              font-size: 48px;
              font-family: Comfortaa;
              font-weight: 400;
              word-wrap: break-word;
            "
          >
            hoohoo Feeder
          </div>
        </div>

        <div
          class="Component"
          style="
            width: 139px;
            height: 28px;
            left: 16px;
            top: 659px;
            position: absolute;
          "
        >
          <div
            class="PawelCzerwinski"
            style="
              left: 36px;
              top: 0px;
              position: absolute;
              color: black;
              font-size: 13px;
              font-family: Roboto;
              font-weight: 700;
              word-wrap: break-word;
            "
          >
            Jake Miya
          </div>
          <div
            class="PawelCzerwinski"
            style="
              left: 36px;
              top: 15px;
              position: absolute;
              color: rgba(0, 0, 0, 0.8);
              font-size: 11px;
              font-family: Roboto;
              font-weight: 400;
              word-wrap: break-word;
            "
          >
            @JMhouse
          </div>
          <img
            class="Ellipse"
            style="
              width: 28px;
              height: 28px;
              left: 0px;
              top: 0px;
              position: absolute;
              border-radius: 9999px;
            "
            src="css/images/catLogo_pic.png"
          />
        </div>
      </div>

      <div style="display: inline-flex">
        <p style="color: white; margin: 16">飼料量：</p>
        <div id="slider"></div>
      </div>
      <div style="display: inline- flex">
        <div id="LED_SW">
          <button class="FeedButton" value="Go" name="FeedSW" onClick="test">
            手動餵食
          </button>
        </div>
      </div>
    </div>

    <p></p>
    飼料量：
    <div id="slider"></div>
    送出飼料
    <div>
      <button
        type="button"
        id="FeedButton"
        class="FeedSW"
        value="Go"
        name="FeedSW"
        onClick="test"
      >
        GO
      </button>
    </div>
    LED開關：
    <div id="LED_SW">
      <input type="radio" id="LED_ON" class="SW" value="ON" name="SW" /><label
        for="LED_ON"
        >開</label
      >
      <input
        type="radio"
        id="LED_OFF"
        class="SW"
        checked="checked"
        value="OFF"
        name="SW"
      /><label for="LED_OFF"> 關 </label>
    </div>

    <!-- New functionalities: Current Time and Timer Settings -->
    <div id="currentTime">
      <p>當前時間: <span id="currentDateTime"></span></p>
    </div>
    <div id="timerSettings">
      <h3>手動設定定時功能</h3>
      <label for="daysOfWeek">選擇星期：</label>
      <select id="daysOfWeek" multiple>
        <option value="星期一">星期一</option>
        <option value="星期二">星期二</option>
        <option value="星期三">星期三</option>
        <option value="星期四">星期四</option>
        <option value="星期五">星期五</option>
        <option value="星期六">星期六</option>
        <option value="星期日">星期日</option>
      </select>
      <br />
      <label for="hour">小時：</label>
      <input type="number" id="hour" min="0" max="23" />
      <br />
      <label for="minute">分鐘：</label>
      <input type="number" id="minute" min="0" max="59" />
      <br />
      <button id="addTimerButton">Add</button>
      <button id="removeTimerButton">Remove</button>

      <!-- List to display added timers -->
      <h3>定時清單</h3>
      <ul id="timerList"></ul>
    </div>

    <p>
      My github《<a href="https://github.com/jj21065?tab=repositories"
        >SmartCatFeeder</a
      >》
    </p>

    <script src="js/jquery-1.12.1.min.js"></script>
    <script src="js/jquery-ui.min.js"></script>
    <script>
      var light = 127;
      $(function () {
        // Existing code...
        // $(".FeedSW").click(function (evt) {
        //   // var state = $(this).val();
        //   var state = "go";
        //   $.post("/feed", { feed: state });
        // });
        var btn = document.querySelector(".FeedSW");
        btn.onclick = function () {
          console.log("click");
          var state = "go";
          $.post("/feed", { feed: state });
        };

        $("#LED_SW").buttonset();
        $(".SW").change(function (evt) {
          console.log(".SW");

          var state = $(this).val();
          $.post("/sw", { led: state });
        });

        $("#slider").slider({
          orientation: "horizontal",
          range: "max",
          max: 255,
          value: 127,
          change: function () {
            var val = $(this).slider("value");
            $.post("/foodAmount", { food: val });
          },
        });
        // Fetch current time from the internet
        function getCurrentTime() {
          // $.get("https://worldtimeapi.org/api/ip", function (data) {
          //   var currentDateTime = data.utc_datetime;
          //   $("#currentDateTime").text(currentDateTime);
          // });

          var localDateTime = new Date().toLocaleString();
          $("#currentDateTime").text(localDateTime);
        }

        // Manual timer settings
        $("#addTimerButton").click(function () {
          var selectedDays = $("#daysOfWeek").val();
          var selectedHour = $("#hour").val();
          var selectedMinute = $("#minute").val();

          // Add timer to the list with checkbox
          var timerText =
            "星期" +
            selectedDays.join(", ") +
            " " +
            selectedHour +
            ":" +
            selectedMinute;
          $("<li>")
            .html('<input type="checkbox">' + timerText)
            .appendTo("#timerList");

          // Clear input fields
          $("#hour, #minute").val("");
        });

        // Remove selected timer from the list
        $("#removeTimerButton").click(function () {
          $("#timerList input[type=checkbox]:checked").closest("li").remove();
        });

        // Fetch current time on page load
        getCurrentTime();

        // Update current time every 1 minute (adjust as needed)
        setInterval(getCurrentTime, 10000);
      });
    </script>
  </body>
</html>
